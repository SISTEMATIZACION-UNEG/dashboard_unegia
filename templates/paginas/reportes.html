<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mis Reportes - UNEGIA</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Estilos personalizados -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/reportes.css') }}">
</head>
<body>

<!-- Encabezado -->
<header class="hero-section text-center text-white py-4">
    <a href="/" class="position-absolute top-0 start-0 ms-4 fw-bold text-white text-decoration-none py-5">
        <h4 class="fw-bold mb-2">Cancelar</h4>
    </a>
    <h1 class="fw-bold">Mis Reportes</h1>
    <p class="mb-0">Consulta tus reportes registrados en el sistema UNEGIA</p>
</header>

<!-- Formulario de búsqueda -->
<div class="container mt-5">
    <div class="card shadow-sm p-4">
        <h5 class="mb-3 text-primary">Consultar reportes por cédula</h5>
        <form method="GET" action="{{ url_for('reportes') }}">
            <div class="input-group">
                <input type="text" name="cedula" class="form-control" placeholder="Ingrese su número de cédula" required>
                <button class="btn btn-primary" type="submit">Buscar</button>
            </div>
        </form>
    </div>

    {% if reportes %}
    <div class="mt-5">
        <h4 class="text-center mb-4">Reportes encontrados</h4>

        <div class="table-responsive">
            <table class="table table-bordered table-hover align-middle text-center shadow-sm">
                <thead class="table-primary">
                    <tr>
                        <th>Categoría</th>
                        <th>Tipo de falla</th>
                        <th>Sede</th>
                        <th>Descripción</th>
                        <th>Fecha</th>
                        <th>Foto</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    {% for rep in reportes %}
                        
                        <tr>
                            <td>{{ rep.categoria }}</td>
                            <td>{{ rep.tipo_falla }}</td>
                            <td>{{ rep.sede }}</td>
                            <td>{{ rep.descripcion }}</td>
                            <td>{{ rep.fecha_reporte }}</td>
                            <td>
                                {% if rep.foto_path %}
                                
                                    <img src="{{ url_for('static', filename=rep.foto_path) }}"
                                        alt="Foto del reporte"
                                        width="120"
                                        height="90"
                                        style="object-fit: cover; border-radius: 8px; border: 1px solid #ccc;">
                                {% else %}
                                    <span>Sin foto</span>
                                {% endif %}
                            </td>
                            <td>
                                <a href="{{ url_for('editar_reporte', reporte_id=rep.id) }}" class="btn btn-sm btn-warning">Editar</a>


                                <form action="{{ url_for('borrar_reporte', reporte_id=rep.id) }}" method="POST" style="display:inline;">
                                    <button type="submit" class="btn btn-danger btn-sm" onclick="return confirm('¿Seguro que deseas eliminar este reporte?');">
                                        Borrar
                                    </button>
                                </form>
                                
                            </td>
                        </tr>
                        {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    {% elif cedula %}
    <p class="text-center mt-4 text-muted">No se encontraron reportes para esta cédula.</p>
    {% endif %}
</div>

<footer class="text-center mt-5 p-3 bg-light">
    <small>© 2025 Universidad Nacional Experimental de Guayana</small>
</footer>

</body>
</html>
